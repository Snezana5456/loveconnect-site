<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCq9EW1JNuJmqn1kZyMHyB0u5AGnuXwCeQ",
    authDomain: "loveconnect-e7435.firebaseapp.com",
    projectId: "loveconnect-e7435",
    storageBucket: "loveconnect-e7435.firebasestorage.app",
    messagingSenderId: "1013998982426",
    appId: "1:1013998982426:web:7b6df475ff7063a29308a3",
    measurementId: "G-9F0PESYHMH"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  async function signup() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const name = document.getElementById("name").value;
    const dob = document.getElementById("dob").value;
    const gender = document.getElementById("gender").value;
    const about = document.getElementById("about").value;

    try {
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;

      await setDoc(doc(db, "users", user.uid), {
        email,
        name,
        dob,
        gender,
        about,
      });

      alert("Регистрация успешна!");
    } catch (error) {
      alert("Ошибка регистрации: " + error.message);
    }
  }

  async function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    try {
      await signInWithEmailAndPassword(auth, email, password);
      alert("Вход выполнен!");
    } catch (error) {
      alert("Ошибка входа: " + error.message);
    }
  }

  async function logout() {
    try {
      await signOut(auth);
      alert("Вы вышли из аккаунта.");
    } catch (error) {
      alert("Ошибка выхода: " + error.message);
    }
  }

  // Назначение событий
  document.getElementById("signupBtn")?.addEventListener("click", signup);
  document.getElementById("loginBtn")?.addEventListener("click", login);
  document.getElementById("logoutBtn")?.addEventListener("click", logout);
</script>
